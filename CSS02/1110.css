:root {
  --brand:#0a67c0;
  --bg:#f7f9fc;
  --panel:#ffffff;
  --line:#e6eef8;
  --muted:#6b7280;
}
html, body {
  height: auto;
  overflow-x: hidden; /* é˜²æ­¢æ°´å¹³æ»¾å‹• */
  overflow-y: auto;   /* âœ… é–‹å•Ÿå‚ç›´æ»¾å‹• */
}

*{box-sizing:border-box}
.header {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  padding: 0 40px;
  z-index: 1000;

  /* === ğŸ‘‡ æ–°å¢æ¨¡ç³Šèˆ‡é€æ˜æ•ˆæœ === */

  backdrop-filter: blur(12px);            /* âœ… æ ¸å¿ƒï¼šèƒŒæ™¯æ¨¡ç³Š */
  -webkit-backdrop-filter: blur(12px);    /* Safari æ”¯æ´ */
  transition: background 0.3s ease, backdrop-filter 0.3s ease;
}

.header-right {
  display: flex;
  flex: 1;
  justify-content: flex-end;

}

.nav-links {
  display: flex;
  align-items: center;
}

.nav-link {
  text-decoration: none;
  color: #000;                 /* Navbar é€£çµ = é»‘è‰² */
  font-weight: 600;
  margin-left: 24px;
  transition: color 0.2s ease;
}

.nav-link:hover {
  color: #f5f5f5;
}
body {
  margin: 0;
  padding: 16px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background-image: url('./img1.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  /* âœ… é—œéµä¿®æ”¹ */
  min-height: 100vh;      /* ä¿æŒèƒŒæ™¯æ»¿ç‰ˆï¼Œä½†å…è¨±è¶…å‡ºç•«é¢æ™‚æ»¾å‹• */
  overflow-x: hidden;     /* é˜²æ­¢æ°´å¹³æ²å‹• */
  overflow-y: auto;       /* âœ… é–‹å•Ÿå‚ç›´æ»¾å‹• */
}

/* === è®“ä¸»è¦å…§å®¹ä¸æœƒè¢« header å£“ä½ === */
.container {
  margin-top: 10px;        /* å¿…é ˆæ¯” .header é«˜åº¦ç•¥å¤§ä¸€é» */
  max-width: 1200px;       /* åŸæœ¬è‹¥ç‚º 800ï¼Œå¯æ”¾å¤§ç‚º 1200 */
  width: 90%;              /* è®“å…§å®¹è‡ªé©æ‡‰è¦–çª—å¯¬åº¦ */
  margin-left: auto;
  margin-right: auto;
  background: white;
  padding: 20px 40px;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
/* === é é¦–æ¨™é¡Œï¼ˆå°é½Šç™½è‰²æ¡†ï¼‰ === */
.front {
  max-width: 1200px;
  width: 90%;
  margin: 70px auto 10px auto;  /* âœ… æ”¹é€™è¡Œï¼Œç¸®å°èˆ‡ navbar é–“è· */
  text-align: left;
}

.front h1 {
  font-size: 1.8rem;
  font-weight: 700;
  margin-bottom: 6px;
  color: #111;
}

.front .muted {
  font-size: 0.95rem;
  color: #333;
}

h1{font-size:1.6rem;margin:0 0 8px}
h2{font-size:1.2rem;border-left:4px solid var(--brand);padding-left:10px;margin:20px 0 10px;display:flex;align-items:center;gap:8px}
h3{font-size:1.05rem;margin:14px 0 8px;color:#0b4b8a}
.muted{color:var(--muted);font-size:.9rem}
.card{background:#fff;border:1px solid var(--line);border-radius:12px;padding:14px}

.row-2col{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
@media (max-width: 900px){.row-2col{grid-template-columns:1fr}}
.grid4{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
@media (max-width: 960px){.grid4{grid-template-columns:1fr}}

label{display:block;font-size:.9rem;color:#374151;margin-bottom:6px}
input[type="number"],input[type="date"],input[type="text"]{
  width:100%;padding:8px 10px;border:1px solid #d6e3f3;border-radius:8px;background:#fbfdff
}

.btn{display:inline-flex;align-items:center;gap:8px;background:var(--brand);border:none;color:#fff;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700}
.btn.ghost{background:#fff;color:#0b4b8a;border:1px solid #b9d7ff}
.mini-btn{margin-left:6px;font-size:.82rem;padding:6px 10px;border-radius:8px;border:1px solid #b9d7ff;background:#fff;color:#0b4b8a;cursor:pointer}
.link{background:transparent;border:none;color:#0a67c0;cursor:pointer;text-decoration:underline}

.kpi{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
@media (max-width: 960px){.kpi{grid-template-columns:1fr 1fr}}
.kpi .card{border-radius:12px;border:1px solid #e7eef8;background:#f9fcff}
.kpi .title{font-size:.9rem;color:#334155}
.kpi .value{font-weight:800;font-size:1.4rem}
.kpi .sub{color:#6b7280;font-size:.82rem}

table{width:100%;border-collapse:collapse}
.ie-table thead th{background:#f6faff;border-bottom:1px solid #e3eefb;color:#334155}
.ie-table th,.ie-table td{padding:8px 10px;border-bottom:1px dashed #e8eef7;text-align:right}
.ie-table .left{text-align:left}
.ie-table .act{width:72px;text-align:center}
.ie-table.onecol td:nth-child(2), .ie-table.onecol th:nth-child(2){width:280px}
.matrix-wrap{overflow:auto;border:1px solid #e7eef8;border-radius:12px}
.matrix th,.matrix td{padding:8px 10px;border-bottom:1px dashed #e8eef7;text-align:right}
.matrix th:first-child,.matrix td:first-child{text-align:left;color:#334155}
.total-row td{font-weight:700;border-bottom:2px solid #dbe8fb}

.chart-wrap{margin-top:10px;border:1px solid #e7eef8;background:#fff;border-radius:12px;padding:10px; margin-bottom:10px}
details{border:1px solid #e7eef8;border-radius:12px;margin:12px 0;background:#fcfdff}
summary{cursor:pointer;padding:10px 12px;font-weight:700;color:#0b4b8a}

.year-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;padding:0 14px 14px}
@media (max-width: 1200px){.year-grid{grid-template-columns:1fr}}

.soft{border:0;border-top:1px dashed #e7eef8;margin:12px 0}

/* ===== Modal ===== */
.modal{
  position:fixed;inset:0;display:none;align-items:center;justify-content:center;
  background:rgba(0,0,0,.45);z-index:9999;padding:16px;
}
.modal-card{
  width:520px;max-width:100%;background:#fff;border-radius:14px;border:1px solid var(--line);
  box-shadow:0 10px 30px rgba(0,0,0,.15);padding:18px 18px 58px;position:relative;
}
.modal-title{font-size:1.2rem;color:#0b4b8a;font-weight:800;margin-bottom:10px;border-left:4px solid var(--brand);padding-left:8px}
.ck{display:flex;align-items:center;gap:10px;margin:10px 0;color:#374151}
.ck-disabled{opacity:.6}
.exists-hint{color:#6b7280;font-size:.85em;margin-left:4px}
.modal-actions{position:absolute;right:18px;bottom:14px;display:flex;gap:8px}
.modal-x{
  position:absolute;right:10px;top:8px;background:#fff;border:1px solid #d9e6fb;border-radius:8px;
  padding:2px 8px;cursor:pointer;color:#0b4b8a;font-weight:700
}

/* è®“ select å¤–è§€èˆ‡ input å®Œå…¨ä¸€è‡´ï¼ˆå‰æ¬¡å·²åŠ å…¥ï¼Œä¿ç•™ï¼‰ */
select{
  width:100%;
  padding:8px 36px 8px 10px;
  border:1px solid #d6e3f3;
  border-radius:8px;
  background:#fbfdff;
  color:#111;
  font:inherit;
  line-height:1.4;
  appearance:none; -webkit-appearance:none; -moz-appearance:none;
  background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%230a67c0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 9 12 15 18 9'/></svg>");
  background-repeat:no-repeat;
  background-position:right 10px center;
  background-size:16px;
}
select:hover{ border-color:#b9d7ff; }
select:focus{ outline:none; border-color:#93c5fd; box-shadow:0 0 0 3px rgba(10,103,192,.12); }
select::-ms-expand{ display:none; }
h3{
  padding-left: 3px;
  font-size: 22px;
}
h4{
    padding-left: 8px;
}
@media print {
  .chart-wrap, .card, table { break-inside: avoid; page-break-inside: avoid; }
  .page-break { page-break-before: always; break-before: page; }
}
/* ============= åªåœ¨ PDF ç‰ˆé¢ç”Ÿæ•ˆçš„å…¨åŸŸç¸®å° ============= */
.pdf-root { font-size: 12px; }  /* åŸºæº–å­—å†ç¸®ä¸€ç´š */

/* â‘  KPI å­—é«”éå¤§ â†’ é‡å° KPI å¡ç¸®å°å±¤ç´š */
.pdf-root .kpi .title { font-size: 11.5px; }
.pdf-root .kpi .value { font-size: 19px; line-height: 1.15; }
.pdf-root .kpi .sub   { font-size: 10.5px; opacity: .75; }

/* â‘¡ æŸäº›æ¨™é¡Œï¼ˆä¾‹å¦‚è³‡ç”¢è² å‚µè¡¨é¡ï¼‰å¤ªè²¼é ç·£ â†’ è®“æ¯å€‹ç« ç¯€å¡Šé ‚éƒ¨å¤šä¸€é»å…§è· */
.pdf-root .pdf-block { padding-top: 4mm; break-inside: avoid; page-break-inside: avoid; }
/* ç¬¬ä¸€å€‹ç« ç¯€ä¸åŠ è·é›¢ï¼Œé¿å…ç™½é‚Šå¤ªå¯¬ */
.pdf-root .pdf-block:first-child { padding-top: 0; }

/* â‘¢ åŸºæœŸå¹´åº¦ä¸‰è¡¨æ’ç‰ˆæ€ªï¼ˆå¡ç‰‡è¢«åˆ†é æˆ–æ“ ä½ç§»ï¼‰â†’ å›ºå®šä¸‰æ¬„æ ¼å±€ã€é¿å…æ‹†é  */
.pdf-root .year-grid {
  display: grid !important;
  grid-template-columns: repeat(3, minmax(0,1fr));
  gap: 12px;
  align-items: start;
  break-inside: avoid; page-break-inside: avoid;
}
.pdf-root .year-grid .card { break-inside: avoid; page-break-inside: avoid; }
.pdf-root details { break-inside: avoid; page-break-inside: avoid; }

/* â‘£ é æ¸¬å ±è¡¨ï¼ˆä¾‹å¦‚ã€Œæç›Šè¡¨ï¼ˆ2028ï¼‰ã€ç­‰ï¼‰æ¨™é¡Œå¤ªå¤§ â†’ å…¨åŸŸ h3 é™ç´šã€ä¸‰è¡¨å…§æ¨™é¡Œå†å°ä¸€éš */
.pdf-root h3 { font-size: 16px; margin: 0 0 6px; line-height: 1.25; page-break-after: avoid; }
.pdf-root .year-grid h3 { font-size: 15px; margin-bottom: 6px; }

/* è¡¨æ ¼åœ¨ PDF å…§ç¸®ä¸€ç´šé–“è·ï¼ˆé¿å…æ’é ï¼‰ï¼Œä¹Ÿè®“è¡Œé«˜æ›´ç·Šæ¹Šä¸€é» */
.pdf-root .matrix th,
.pdf-root .matrix td { padding: 6px 8px; font-size: 12px; line-height: 1.3; }

/* è®“é¡è‰²æ¥è¿‘è¢å¹•ï¼ˆéå¿…è¦ï¼Œä½† PDF æœƒæ›´ç¾è§€ï¼‰ */
* { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
/* ä¸€å€‹ç« ç¯€å…§çš„ã€Œå°æ¨™é¡Œ + è¡¨æ ¼ã€åˆç¶ï¼šä¸è¦è¢«æ‹†é  */
.pdf-root .matrix-section{
  break-inside: avoid;
  page-break-inside: avoid;
  padding-top: 2mm;                /* è®“æ¨™é¡Œé›¢é é ‚æœ‰é»è·é›¢ï¼Œé¿å…è²¼é‚Š */
  margin-bottom: 10px;
}

/* å°æ¨™é¡Œæœ¬èº«ä¹Ÿé¿å…åœ¨å¾Œé¢ç”¢ç”Ÿåˆ†é  */
.pdf-root .matrix-section .subttl{
  page-break-after: avoid;
  margin: 0 0 4px;
  font-weight: 600;
}

/* å°æ¨™é¡Œèˆ‡è¡¨æ ¼ä¹‹é–“ä¸è¦å†æœ‰å¤šé¤˜é–“è·ï¼ˆé¿å…ã€Œæ–·åœ¨ margin ä¸Šã€ï¼‰ */
.pdf-root .matrix-section .matrix{
  margin-top: 0;
}

/* === å¯æ‹–æ›³å€å¡Šï¼ˆåŸºç¤æ¨£å¼ï¼‰ === */
.draggable {
  cursor: grab;
  transition: transform 0.15s ease, box-shadow 0.2s ease;
}
.draggable:active {
  cursor: grabbing;
}
/* æ¯å€‹å¯æ‹–æ‹‰å€å¡Šçš„æ¨™é¡Œå‰åŠ ä¸Šæ‹–æ‹‰åœ–ç¤º */
/* æ¯å€‹å¯æ‹–æ‹‰å€å¡Šçš„æ¨™é¡Œå‰åŠ ä¸Šæ‹–æ‹‰åœ–ç¤ºï¼ˆç´” CSSï¼Œä¸ç”¨å­—å…ƒï¼‰ */
.draggable > h3::before {
  content: "";
  display: inline-block;
  width: 12px;
  height: 14px;
  margin-right: 6px;
  vertical-align: middle;
  cursor: move;
  /* å…­å€‹å°é»é»çš„æ‹–æ‹‰æ‰‹æŠŠ */
  background-image:
    radial-gradient(#999 1px, transparent 1px),
    radial-gradient(#999 1px, transparent 1px),
    radial-gradient(#999 1px, transparent 1px),
    radial-gradient(#999 1px, transparent 1px),
    radial-gradient(#999 1px, transparent 1px),
    radial-gradient(#999 1px, transparent 1px);
  background-position:
    0 0,      6px 0,
    0 6px,    6px 6px,
    0 12px,   6px 12px;
  background-size: 6px 6px;
  background-repeat: no-repeat;
}



/* === æ‹–æ›³ä¸­çš„ç‹€æ…‹ === */
.sortable-chosen {
  opacity: 1;  /* è¢«æ‹–å‹•çš„å€å¡Šä¿æŒå®Œæ•´é¡¯ç¤º */
  box-shadow: 0 6px 16px rgba(0,0,0,.25);
}
.sortable-ghost {
  opacity: 0.3;               /* åŸä½ç½®ç•™ä¸€å€‹åŠé€æ˜å½±å­ */
  background: inherit;
  border: 1px solid #93c5fd;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,.18);
}

/* === æ¨™é¡Œä½œç‚ºæ‹–æ›³æ‰‹æŠŠï¼ˆæ”¹ç‚ºåƒ…åœ¨ .draggable ä¸­é¡¯ç¤ºï¼‰ === */

/* é è¨­ï¼šéš±è—æ‰€æœ‰ h3 çš„æ‰‹æŠŠï¼ˆé€™æœƒå½±éŸ¿å¹´åº¦ä¸‰è¡¨å…§çš„ h3 èˆ‡ #number_format_settings h3ï¼‰ */
h3::before {
  content: none;
  display: none;
}

/* åªæœ‰åœ¨ .draggable è£¡çš„ h3 é¡¯ç¤ºæ‹–æ›³æ‰‹æŠŠä¸¦è¨­å®šæ¸¸æ¨™ï¼ˆè®“ä½¿ç”¨è€…çŸ¥é“å¯æ‹–æ›³ï¼‰ */
.draggable h3 {
  cursor: grab;
}
.draggable h3:active {
  cursor: grabbing;
}
.draggable h3::before {
  content: "â‹®â‹®"; /* æ‹–æ›³æ‰‹æŠŠå­—å…ƒ */
  font-size: 16px;
  color: #888;
  margin-right: 6px;
  cursor: grab;
  display: inline-block;
}

/* è‹¥ hover æˆ– active æ™‚å¼·åŒ–é¡è‰²ï¼ˆå¯é¸ï¼‰ */
.draggable h3:hover::before {
  color: #666;
}
.draggable h3:active::before {
  color: #0a67c0;
}

/* === æ»‘é¼  hover æç¤º === */
.draggable:hover {
  box-shadow: 0 4px 12px rgba(0,0,0,.12);
  border: 1px solid #93c5fd;
  background: #f0f8ff;
  border-radius: 12px;
  transition: all 0.2s ease;
}

#number_format_settings {
  background: #fafafa;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 10px 15px;
}

#number_format_settings h3 {
  margin: 0 0 8px;
  font-size: 16px;
  font-weight: 600;
}

#number_format_settings select {
  padding: 4px 8px;
  font-size: 14px;
}

.total-row td:first-child {
  color: #0a67c0;
}

/* è®“æç›Šè¡¨çš„å·¦æ¬„ï¼ˆç§‘ç›®åç¨±ï¼‰é å·¦å°é½Š */
.ie-table td:first-child {
  text-align: left !important;
  padding-left: 12px; /* å¯ä¾éœ€è¦å¾®èª¿ç¸®æ’ */
}

/* è®“é‡‘é¡æ¬„ä¿æŒé å³å°é½Š */
.ie-table td:last-child {
  text-align: right !important;
  padding-right: 12px;
}

.footer-copyright {
  position: fixed;
  bottom: 10px;
  left: 20px;
  font-size: 12px;
  color: rgba(0, 0, 0, 0.5);
  font-family: "Inter", "Noto Sans TC", sans-serif;
  z-index: 1000;
  user-select: none;
}