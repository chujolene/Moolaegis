/* ===== 基本設定 ===== */
:root {
  --font-base: 'Noto Sans', sans-serif;
  --chat-max: 1400px;
  --container-max: calc(var(--chat-max) + 40px);
  --header-h: 72px;                 /* 建議與實際 header 高度一致 */
  --color-bg: rgba(255,255,255,.85);
  --color-input-bg: #fff;
  --color-primary: #121417;
  --radius-lg: 18px;
  --radius-md: 12px;

  /* 依品牌調色 */
  --bubble-user-bg: #eaf2ff;        /* 使用者：淡藍 */
  --bubble-user-border: #cfdcff;
  --bubble-bot-bg:  #f6f7f9;        /* AI：淡灰 */
  --bubble-bot-border: rgba(0,0,0,.06);
}

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  font-family: var(--font-base);
}
*, *::before, *::after { box-sizing: border-box; }

.layout-wrapper {
  position: relative;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  overflow-x: hidden;
  background: url('img1.png') center/cover no-repeat; /* 路徑請以 CSS 檔為相對基準 */
}

/* i18n 下拉 */
.i18n-header__select{
  padding:.25rem .5rem;
  border-radius:.5rem;
  border:1px solid #ddd;
  background:#c8c0ae;
  backdrop-filter: blur(20px);
  font: 600 16px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans";
  color: #fff;
}
.i18n-header__select:focus-visible{
  outline: 2px solid rgba(200,192,174,.8);
  outline-offset: 2px;
}

/* ===== Header ===== */
.header {
  position: fixed;
  top: 0;
  left: 0;               /* 讓頂欄吃滿寬度 */
  right: 0;
  padding: 12px 40px;
  z-index: 1000;
  background: transparent;
}
.header-right {
  display: flex;
  flex: 1;
  justify-content: flex-end;
  gap: 32px;
}
.nav-links { display: flex; align-items: center; gap: 36px; }
.nav-link {
  color: #121417;
  font-size: 15px;
  font-weight: 500;
  text-decoration: none;
}
.nav-link:hover { text-decoration: underline; }

/* ===== Main ===== */
.main-content{
  padding-top: var(--header-h);
  display: flex;
  justify-content: center;
  flex: 1;
}
.content-container{
  display: flex;
  flex-direction: column;
  width: 100%;
  max-width: var(--container-max);
}

/* 標題 */
.page-title-section{
  display: flex;
  justify-content: center;
  padding: 0 15px 0;
  margin-bottom: 10px;
}
.page-title{
  text-align: center;
  margin: 0 0 15px;
  color: #121417;
  font-size: 32px;
  font-weight: bold;
}

/* ===== 聊天卡片：Grid 兩列，上訊息，下輸入列 ===== */
.chat-box{
  width: clamp(280px, 85vw, var(--chat-max));
  margin: 0 auto;
  background: var(--color-bg);
  backdrop-filter: blur(8px);
  border: 1px solid rgba(255,255,255,0.8);
  border-radius: var(--radius-lg);
  box-shadow: 0 4px 16px rgba(0,0,0,0.08);

  position: relative;
  height: clamp(520px, 75vh, 900px);
  display: grid;
  grid-template-rows: 1fr auto;     /* 上：訊息；下：輸入列 */
  gap: 12px;
  padding: 24px;
  overflow: hidden;                  /* 保持圓角/陰影 */
}

/* 訊息列表：自滾動區 */
#messages{
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 0 4px 12px;
  min-height: 0;                     /* Grid/Flex 容器內能正確滾動 */
  overflow-y: auto;
  overscroll-behavior: contain;      /* 不連動整頁 */
  scroll-padding-block-end: 12px;    /* 捲到底留緩衝 */
  -webkit-overflow-scrolling: touch; /* iOS 慣性捲動 */
  scrollbar-gutter: stable;          /* 避免捲軸出現造成 reflow */
}

/* 輸入列（固定在 Grid 下方） */
.chat-bar{
  position: static;
  display: flex;
  align-items: center;
  background: var(--color-input-bg);
  border-radius: var(--radius-md);
  overflow: hidden;
  padding-left: 16px;
  padding-inline: 12px;
  padding-block: 8px;
  box-shadow: 0 -2px 6px rgba(0,0,0,.03);
  margin-bottom: env(safe-area-inset-bottom, 0); /* iOS 安全區 */
}

/* 訊息泡泡共用 */
.message{
  max-width: min(80%, 1000px);
  padding: 12px 14px;
  border-radius: 14px;
  line-height: 1.6;
  font-size: 15px;
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  hyphens: auto;                     /* 英文自動斷詞 */
  box-shadow: 0 1px 2px rgba(0,0,0,.06);
}

/* RTL 語系時自動對調左右 */
[dir="rtl"] .user-message { align-self: flex-start; }
[dir="rtl"] .bot-message  { align-self: flex-end;   }

/* 使用者／AI 泡泡 */
.user-message{
  align-self: flex-end;
  background: var(--bubble-user-bg);
  border: 1px solid var(--bubble-user-border);
  border-bottom-right-radius: 6px;
}
.bot-message{
  align-self: flex-start;
  background: var(--bubble-bot-bg);
  border: 1px solid var(--bubble-bot-border);
  border-bottom-left-radius: 6px;
}
.bot-message.typing{ opacity:.7; font-style: italic; }

/* 泡泡內細節 */
.message a{ color:#3b63e6; text-decoration: underline; }
.message code{
  background: rgba(0,0,0,.05);
  padding: .1em .35em;
  border-radius: 4px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: .95em;
}

/* 輸入元件 */
.chat-input{
  flex: 1;
  min-width: 0;
  border: none;
  background: transparent;
  height: 48px;
  font-size: 16px;
  color: #121417;
  padding-right: 8px;
}
.chat-input::placeholder { color: #677583; }
.chat-input:focus-visible{
  outline: 2px solid rgba(200,192,174,.8);
  outline-offset: 2px;
}

/* + 按鈕／送出按鈕 */
.upload-btn{
  width: 40px; height: 40px; border-radius: 50%;
  margin: 2px 8px; background: #e7c1a6; color:#121417;
  display:flex; align-items:center; justify-content:center;
  cursor: pointer; font-size: 24px; line-height: 1; border: none;
}
.upload-btn:hover{ background:#907867; }
.upload-btn:focus-visible{
  outline: 2px solid rgba(200,192,174,.8);
  outline-offset: 2px;
}

.send-btn{
  height: 40px; padding: 0 24px; margin-right: 4px;
  border-radius: 24px; border: none; background: #ccc;
  color: #121417; font-size: 16px; cursor: pointer; white-space: nowrap;
}
.send-btn:hover{ background: #a1a0a0; }
.send-btn:focus-visible{
  outline: 2px solid rgba(200,192,174,.8);
  outline-offset: 2px;
}

/* ===== 其他（上傳區若還會用） ===== */
.upload-section { display: none; }

/* 基本工具類 */
.hidden { display: none; }

/* 最外層遮罩 */
.overlay{
  position: fixed; inset: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex; justify-content: center; align-items: center;
  z-index: 2000;
}
.overlay.hidden, .result-section.hidden{ display: none !important; }

/* Modal */
.modal-box{
  background: #fff; padding: 20px; border-radius: 12px;
  width: 90%; max-width: 600px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.12);
}
.btn-row{
  display: flex; justify-content: flex-end; gap: 12px; margin-top: 12px;
}
.modal-title{
  margin: 0 0 12px; font-size: 25px; font-weight: 600; color: #333;
  font-family: 'Noto Sans', sans-serif;
}
.divider{ margin: 16px 0; border: 0; border-top: 1px solid #e0e0e0; }
.preview-img{
  max-width: 100%; max-height: 200px; display: block;
  margin: 10px 0; object-fit: contain;
}
.result-section{ margin-top: 10px; }
.result-title{ margin: 0 0 8px; font-size: 16px; font-weight: 500; }
.result-text{
  width: 100%; height: 100px; resize: vertical; padding: 8px;
  font-size: 14px; line-height: 1.4; border: 1px solid #ccc;
  border-radius: 6px; margin-bottom: 10px;
}

/* 按鈕共用 */
.btn{
  cursor: pointer; border: none; border-radius: 6px;
  padding: 8px 16px; font-size: 14px; line-height: 1.2;
  color: #121417; background: #f1f2f4; transition: background .2s;
}
.btn:hover{ background: #e1e2e5; }
.btn-primary{ background: #e7c1a6; color: #333; }
.btn-primary:hover{ background: #d4ae94; }
.btn-secondary{ background: #e7c1a6; }
.btn-secondary:hover{ background: #d4ae94; }
.btn-close{ background: #ccc; }
.btn-close:hover{ background: #b3b3b3; }

/* ===== 響應式 ===== */
@media (max-width: 768px){
  .main-content { padding-top: var(--header-h); } /* 不用魔數 100px */
  .header { padding: 12px 20px; }
  .nav-links, .header-right { gap: 20px; }
  .page-title { font-size: 24px; }

  .chat-box{
    height: 65vh;
    padding: 16px;        /* Grid 版不需再留 96px 的底部空隙 */
  }
  .chat-bar{ width: auto; }  /* 讓 Grid 決定寬度即可 */
}

@media (max-width: 480px){
  .nav-links { display: none; }
  .page-title { font-size: 20px; }
  .chat-input { font-size: 14px; }
}
